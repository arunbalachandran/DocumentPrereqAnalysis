<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Prerequisite Analyzer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <meta name="generator" content="Google Web Designer 1.7.3.0307">
    <!-- <link rel="icon" href="../../favicon.ico"> -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/vis/4.16.1/vis.css" type="text/css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/shepherd/1.7.0/css/shepherd-theme-arrows.css" type="text/css" />
    <link rel="stylesheet" href="http://code.ionicframework.com/ionicons/2.0.1/css/ionicons.min.css" type="text/css" />
    <link href="https://fonts.googleapis.com/css?family=Indie+Flower" rel="stylesheet" type="text/css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/triplewindow.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/style.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/bar.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/buttongroup.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/shepherd-custom.css') }}">
    <!-- <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/commafield.css') }}"> -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/welcome.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/modals.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/progress.css') }}">
    <!-- Custom styles for this template -->
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/starter-template.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='css/amazonscraper.css') }}">

    <script>  // use this in the below binding script
      var graphNodes = {{ nodes|tojson }};
      function LoadGoogle()
      {
          if (typeof google != 'undefined' && google && google.load && "temp" != document.getElementById("namecontainer").getAttribute("name")) {
              console.log('Finished loading google api!');
              var clickedNode = document.getElementById('namecontainer').getAttribute('name');
              var element = google.search.cse.element.getElement('search-box');
              var returnVal = element.prefillQuery(clickedNode);
              console.log("Filled element with value", clickedNode);
              console.log("Return value is ", returnVal);
              $("td.gsc-search-button").hide();
              // debugger;
              $(".gsc-search-button").click();
              // debugger;
              setTimeout(function() {
                  $(".gsc-cursor-box").hide();
              }, 1000)
              // $(".gsc-cursor").hide();
              $.ajax({
                type : "POST",
                url : "{{url_for('node_clicked')}}",
                data : JSON.stringify({'clickdata': clickedNode}),
                contentType: 'application/json;charset=UTF-8',
                success: function(data) {
                    console.log("Success case!");
                    var parsedData = JSON.parse(data);
                    console.log("No problems here");
                    // $('.loadingGif').fadeOut('1000');
                    $("#scholardiv").html(parsedData['data1']);
                    $("#amazonDiv").html(parsedData['data2']);
                },
                error: function (data) {
                    console.log("failure case!");
                }
              });
          }
          else {  // Retry later...
              setTimeout(LoadGoogle, 500);
          }
      }
    </script>
    <script type="text/javascript" src="https://code.jquery.com/jquery.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
    <script>
        $(document).ready(function() {   // before the window resize
            $('.col-md-3').height( $(window).width() / 4 );
            $('.col-md-9').height( $(window).width() / 4 );
            $('.col-md-6').height( $(window).width() / 4 );
        })
    </script>
    <script>
        $(window).on( 'resize', function () {
            $('.col-md-3').height( $(window).width() / 4 );
            $('.col-md-9').height( $(window).width() / 4 );
            $('.col-md-6').height( $(window).width() / 4 );
        }).resize();
    </script>
    <style>
      .navbar {
        margin-bottom: 0px;
      }
    </style>
  </head>
  <!-- <body class="htmlNoPages"> -->
  <body>
    <nav class="navbar navbar-default">
      <div class="navbar-header">
        <a href="#" class="navbar-brand">Document Prerequisite Classifier</a>
      </div>
      <div class="navbar-collapse collapse" id="navbar">
        <ul class="nav navbar-nav">
          <li><a href="{{ url_for('show_logout') }}" style="margin-left: 1500%">Logout</a></li>
        </ul>
      </div>
    </nav>

    <div class="container-fluid">
      <div class="row">  <!-- Need to make the height for the nodes container (namecontainer) variable ! -->
        <div class="col-md-9" id="namecontainer">
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/vis/4.16.1/vis-network.min.js"> </script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.5.12/clipboard.min.js"> </script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/tether/1.3.3/js/tether.min.js"> </script>
          <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/shepherd/1.7.0/js/shepherd.min.js"> </script>
          <script type="text/javascript" src="{{ url_for('static', filename='js/api.js') }}"> </script>
          <script type="text/javascript" src="{{ url_for('static', filename='js/helpers.js') }}"> </script>
          <script type="text/javascript" src="{{ url_for('static', filename='js/main_functions.js') }}"> </script>
          <script type="text/javascript" src="{{ url_for('static', filename='js/help.js') }}"> </script>
          <script type="text/javascript" src="{{ url_for('static', filename='js/main.js') }}"> </script>
          <script type="text/javascript" src="{{ url_for('static', filename='js/network_serialize.js') }}"> </script>
          <script type="text/javascript" src="{{ url_for('static', filename='js/bindings.js') }}"> </script>
          <!-- <script type="text/javascript" src="{{ url_for('static', filename='js/commafield.js') }}"> </script> -->
          <script type="text/javascript" src="{{ url_for('static', filename='js/modals.js') }}"> </script>
          <script type="text/javascript" src="{{ url_for('static', filename='js/progress.js') }}"> </script>
          <script>
            // Run events that need to happen on initialization.
            window.onload = function () {
                bind();
            };
          </script>
        </div>
        <div class="col-md-3 gwd-div-zptc">  <!-- need to make this height variable -->
          <script>
            (function() {
              var cx = '009466571335008187859:dnoy-cwjbye';
              var gcse = document.createElement('script');
              gcse.type = 'text/javascript';
              gcse.async = true;
              gcse.src = 'https://cse.google.com/cse.js?cx=' + cx;
              var s = document.getElementsByTagName('script')[0];
              s.parentNode.insertBefore(gcse, s);
              console.log("insertion complete");
            })();
          </script>
          <gcse:search gname="search-box"></gcse:search>
        </div>
      <!-- </div> -->
      <!-- <div class="row"> -->
        <div class="col-md-6 gwd-div-sqmu gwd-gen-9lgjgwdanimation" id="scholardiv">
          <p style="text-align: center; margin-top: 23%;">Click a node to view a list of papers related to that research topic.</p>
          <img src="{{ url_for('static', filename='img/ajax-loader.gif') }}" class="loadingGif">
        </div>
        <div class="col-md-6 gwd-div-14zh" id="amazonDiv">
          <p style="text-align: center; margin-top: 23%;">Click a node to view a list of books on Amazon relevant to that topic.</p>
          <img src="{{ url_for('static', filename='img/ajax-loader.gif') }}" class="loadingGif">
        </div>
      <!-- </div> -->
    </div>
  </body>

  <script>
      $(document).ready(function() {
          //Make the change here to get the clicked node. AJAX call would be the same.
          console.log("The document is ready!");
          // $('.gsc-search-box').hide();
          $('.loadingGif').hide();
          $('.gsc-search-button').hide();
          LoadGoogle();
          // $(document).ajaxStart(function() {
              // $('.loadingGif').show();
          // })
      });
  </script>
</html>
